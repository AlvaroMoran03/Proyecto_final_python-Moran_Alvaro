{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Trabajo Final"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "import pandas as pd\n",
    "import altair as alt\n",
    "import numpy as np"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "Indicador_desarrollo = pd.read_csv(\"../Datos/51f7ab6a-24ed-4a06-9f5d-04873f1673fd_Data-1.csv\")"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Ordenamiento de Datos"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "Indicador_desarrollo = Indicador_desarrollo[Indicador_desarrollo[\"Country Code\"].notna()]\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "Indicador_desarrollo = Indicador_desarrollo.melt( id_vars = [\"Country Name\",\"Series Name\",\"Country Code\"],\n",
    "                   value_vars=Indicador_desarrollo.loc[:, \"1960 [YR1960]\":\"2022 [YR2022]\"])\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "Indicador_desarrollo = Indicador_desarrollo.rename(columns={\"variable\": \"year\"})\n",
    "#Renombro la columna para conseguir finalmente una columna year que marque el año correspondiente\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "Indicadores = Indicador_desarrollo.pivot(\n",
    "    index=[\"Country Name\", \"year\",\"Country Code\"],\n",
    "    columns=\"Series Name\",\n",
    "    values=\"value\"\n",
    ").reset_index()\n",
    "\n",
    "#Vuelvo a retransformar el dataframe para volver de long a wide,pero en este caso para generar columnas por cada indicador"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "Indicadores.replace({\"..\":np.nan}, inplace = True) \n",
    "#Reemplazo por valores nulos aquellos que tienen esta forma \"..\" que marca que no hay valor para ese año de ese  indicador"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "Indicadores[\"Hospital beds (per 1,000 people)\"]=Indicadores[\"Hospital beds (per 1,000 people)\"].astype(float)\n",
    "Indicadores[\"CO2 emissions (metric tons per capita)\"]=Indicadores[\"CO2 emissions (metric tons per capita)\"].astype(float)\n",
    "Indicadores[\"Access to electricity (% of population)\"]=Indicadores[\"Access to electricity (% of population)\"].astype(float)\n",
    "Indicadores[\"year\"] = Indicadores[\"year\"].str.slice(stop=4)\n",
    "Indicadores[\"year\"] = Indicadores[\"year\"].astype(int)\n",
    "#realizo transformaciones a mis indicadores para volverlas variables numerica\""
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "Indicadores[\"Country Name\"].unique()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "region = [\"Africa Eastern and Southern\", \"Africa Western and Central\", \"Arab World\", \"East Asia & Pacific\",\n",
    " \"East Asia & Pacific\", \"European Union\", \"Latin America & Caribbean\",\"Middle East & North Africa\",\"Sub-Saharan Africa\",\"World\"]\n",
    "\n",
    "Indicadores_region = Indicadores[Indicadores[\"Country Name\"].isin(region)]\n",
    "\n",
    "Paises_latam = [\"Peru\",\"Chile\",\"Colombia\",\"Ecuador\",\"Bolivia\",\"Brazil\"]\n",
    "Indicadores_latam = Indicadores[Indicadores[\"Country Name\"].isin(Paises_latam)]\n",
    "\n",
    "ingreso = [ \"High income\", \"Low & middle income\",\n",
    " \"Low income\", \"Lower middle income\",\"World\"]\n",
    "Indicadores_ingreso = Indicadores[Indicadores[\"Country Name\"].isin(ingreso)]\n",
    "\n",
    "#Creo subcalsificaciones que seran de utilidad más adelante\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Gráficos"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Trabajo femenino"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "Indicadores_region_labor = Indicadores_region[Indicadores_region[\"Labor force, female (% of total labor force)\"].notna()]\n",
    "# Eliminamos las filas en donde no se encuentre este indicador para evitar que los años en los que no se registro este dato aparezcaen el gráfico"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "alt.Chart(Indicadores_region_labor).mark_line().encode(\n",
    "    x=alt.X(\"year\"),\n",
    "    y=alt.Y(\"Labor force, female (% of total labor force):Q\"),\n",
    "    color= alt.Color(\"Country Name\"),\n",
    "    tooltip = [\"Country Name\",\"Labor force, female (% of total labor force)\",\"year\"]\n",
    ").interactive()\n",
    "#Se diseña un grafico lineal usando el paquete altair como se vio en clase"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Emiciones de CO2"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "Indicadores_ingreso_carbon = Indicadores_ingreso[Indicadores_ingreso[\"CO2 emissions (metric tons per capita)\"].notna()]\n",
    "# Eliminamos las filas en donde no se encuentre este indicador para evitar que los años en los que no se registro este dato aparezcaen el gráfico"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "alt.Chart(Indicadores_ingreso_carbon).mark_line().encode(\n",
    "    x=alt.X(\"year\"),\n",
    "    y=alt.Y(\"CO2 emissions (metric tons per capita):Q\"),\n",
    "    color= alt.Color(\"Country Name\"),\n",
    "    tooltip = [\"Country Name\",\"CO2 emissions (metric tons per capita)\",\"year\"]\n",
    ").interactive()\n",
    "#Se diseña un grafico lineal con el paquete Altair"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Camas Hospitalarias"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "Indicadores_latam = Indicadores_latam[Indicadores_latam[\"Hospital beds (per 1,000 people)\"].notna()]\n",
    "# Eliminamos las filas en donde no se encuentre este indicador para evitar que los años en los que no se registro este dato aparezcaen el gráfico"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "Indicadores_latam[\"year\"].value_counts()\n",
    "#Se verifica cuales son los años que se tienen los datos para los 6 paises elegidos "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "años = [1960,1990,2016]\n",
    "Indicadores_latam_años = Indicadores_latam[Indicadores_latam[\"year\"].isin(años)]\n",
    "#Se escogen 3 años de muestra y se filtra la base de datos por esos años"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "alt.Chart(Indicadores_latam_años).mark_bar().encode(\n",
    "    y = alt.Y(\"Country Name\"),\n",
    "    x = alt.X(\"Hospital beds (per 1,000 people)\"),\n",
    "    column = alt.Column(\"year\"),\n",
    "    color = alt.Color(\"Country Name\")\n",
    "    )\n",
    "\n",
    "#Se realiza un grafico de barras para comparar la evolucion de las camas de hospital en tres puntos del tiempo"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.11.5"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
